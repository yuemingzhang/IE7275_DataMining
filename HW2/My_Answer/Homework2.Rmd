---
title: "Homework2"
author: 'Yueming Zhang'
date: "2017/10/12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1 (Perform Task2 on US Judge Ratings)

```{r, echo=FALSE}
USJudgeRatings <-
  data.frame(CONT = c(5.7, 6.8, 7.2, 6.8, 7.3, 6.2, 10.6, 7, 7.3, 8.2,
                      7, 6.5, 6.7, 7, 6.5, 7.3, 8, 7.7, 8.3, 9.6, 7.1, 7.6, 6.6, 6.2, 7.5, 7.8,
                      7.1, 7.5, 7.5, 7.1, 6.6, 8.4, 6.9, 7.3, 7.7, 8.5, 6.9, 6.5, 8.3, 8.3, 9,
                      7.1, 8.6), INTG = c(7.9, 8.9, 8.1, 8.8, 6.4, 8.8, 9, 5.9, 8.9, 7.9, 8,
                                          8, 8.6, 7.5, 8.1, 8, 7.6, 7.7, 8.2, 6.9, 8.2, 7.3, 7.4, 8.3, 8.7, 8.9,
                                          8.5, 9, 8.1, 9.2, 7.4, 8, 8.5, 8.9, 6.2, 8.3, 8.3, 8.2, 7.3, 8.2, 7, 8.4,
                                          7.4), DMNR = c(7.7, 8.8, 7.8, 8.5, 4.3, 8.7, 8.9, 4.9, 8.9, 6.7, 7.6, 7.6,
                                                         8.2, 6.4, 8, 7.4, 6.6, 6.7, 7.4, 5.7, 7.7, 6.9, 6.2, 8.1, 8.5, 8.7, 8.3,
                                                         8.9, 7.7, 9, 6.9, 7.9, 7.8, 8.8, 5.1, 8.1, 8, 7.7, 7, 7.8, 5.9, 8.4, 7),
             DILG = c(7.3, 8.5, 7.8, 8.8, 6.5, 8.5, 8.7, 5.1, 8.7, 8.1, 7.4, 7.2, 6.8,
                      6.8, 8, 7.7, 7.2, 7.5, 7.8, 6.6, 7.1, 6.8, 6.2, 7.7, 8.6, 8.9, 8, 8.7,
                      8.2, 9, 8.4, 7.9, 8.5, 8.7, 5.6, 8.3, 8.1, 7.8, 6.8, 8.3, 7, 7.7, 7.5),
             CFMG = c(7.1, 7.8, 7.5, 8.3, 6, 7.9, 8.5, 5.4, 8.6, 7.9, 7.3, 7,
                      6.9, 6.5, 7.9, 7.3, 6.5, 7.4, 7.7, 6.9, 6.6, 6.7, 5.4, 7.4, 8.5,
                      8.7, 7.9, 8.4, 8, 8.4, 8, 7.8, 8.1, 8.4, 5.6, 8.4, 7.9, 7.6, 7,
                      8.4, 7, 7.5, 7.5), DECI = c(7.4, 8.1, 7.6, 8.5, 6.2, 8, 8.5, 5.9,
                                                  8.5, 8, 7.5, 7.1, 6.6, 7, 8, 7.3, 6.5, 7.5, 7.7, 6.6, 6.6, 6.8,
                                                  5.7, 7.3, 8.4, 8.8, 7.9, 8.5, 8.1, 8.6, 7.9, 7.8, 8.2, 8.5, 5.9,
                                                  8.2, 7.9, 7.7, 7.1, 8.3, 7.2, 7.7, 7.7), PREP = c(7.1, 8, 7.5, 8.7,
                                                                                                    5.7, 8.1, 8.5, 4.8, 8.4, 7.9, 7.1, 6.9, 7.1, 6.6, 7.9, 7.3, 6.8,
                                                                                                    7.1, 7.7, 6.2, 6.7, 6.4, 5.8, 7.3, 8.5, 8.9, 7.8, 8.4, 8.2, 9.1,
                                                                                                    8.2, 7.6, 8.4, 8.5, 5.6, 8.2, 7.9, 7.7, 6.7, 7.7, 6.9, 7.8, 7.4),
             FAMI = c(7.1, 8, 7.5, 8.7, 5.7, 8, 8.5, 5.1, 8.4, 8.1, 7.2, 7, 7.3,
                      6.8, 7.8, 7.2, 6.7, 7.3, 7.8, 6, 6.7, 6.3, 5.9, 7.3, 8.5, 9, 7.8,
                      8.3, 8.4, 9.1, 8.4, 7.4, 8.5, 8.5, 5.6, 8.1, 7.7, 7.7, 6.7, 7.6,
                      6.9, 8.2, 7.2), ORAL = c(7.1, 7.8, 7.3, 8.4, 5.1, 8, 8.6, 4.7, 8.4,
                                               7.7, 7.1, 7, 7.2, 6.3, 7.8, 7.1, 6.4, 7.1, 7.5, 5.8, 6.8, 6.3, 5.2,
                                               7.2, 8.4, 8.8, 7.8, 8.3, 8, 8.9, 7.7, 7.4, 8.1, 8.4, 5.3, 7.9, 7.6,
                                               7.5, 6.7, 7.5, 6.5, 8, 6.9), WRIT = c(7, 7.9, 7.4, 8.5, 5.3, 8,
                                                                                     8.4, 4.9, 8.5, 7.8, 7.2, 7.1, 7.2, 6.6, 7.8, 7.2, 6.5, 7.3, 7.6,
                                                                                     5.8, 6.8, 6.3, 5.8, 7.3, 8.4, 8.9, 7.7, 8.3, 8.1, 9, 7.9, 7.4, 8.3,
                                                                                     8.4, 5.5, 8, 7.7, 7.6, 6.7, 7.7, 6.6, 8.1, 7), PHYS = c(8.3, 8.5,
                                                                                                                                             7.9, 8.8, 5.5, 8.6, 9.1, 6.8, 8.8, 8.5, 8.4, 6.9, 8.1, 6.2, 8.4,
                                                                                                                                             8, 6.9, 8.1, 8, 7.2, 7.5, 7.4, 4.7, 7.8, 8.7, 9, 8.3, 8.8, 8.4,
                                                                                                                                             8.9, 8.4, 8.1, 8.7, 8.8, 6.3, 8, 8.1, 8.5, 8, 8.1, 7.6, 8.3, 7.8),
             RTEN = c(7.8, 8.7, 7.8, 8.7, 4.8, 8.6, 9, 5, 8.8, 7.9, 7.7, 7.2,
                      7.7, 6.5, 8, 7.6, 6.7, 7.4, 8, 6, 7.3, 6.6, 5.2, 7.6, 8.7, 9, 8.2,
                      8.7, 8.1, 9.2, 7.5, 7.9, 8.3, 8.8, 5.3, 8.2, 8, 7.7, 7, 7.9, 6.6,
                      8.1, 7.1), row.names = c("AARONSON,L.H.", "ALEXANDER,J.M.",
                                               "ARMENTANO,A.J.", "BERDON,R.I.", "BRACKEN,J.J.", "BURNS,E.B.",
                                               "CALLAHAN,R.J.", "COHEN,S.S.", "DALY,J.J.", "DANNEHY,J.F.",
                                               "DEAN,H.H.", "DEVITA,H.J.", "DRISCOLL,P.J.", "GRILLO,A.E.",
                                               "HADDEN,W.L.JR.", "HAMILL,E.C.", "HEALEY.A.H.", "HULL,T.C.",
                                               "LEVINE,I.", "LEVISTER,R.L.", "MARTIN,L.F.", "MCGRATH,J.F.",
                                               "MIGNONE,A.F.", "MISSAL,H.M.", "MULVEY,H.M.", "NARUK,H.J.",
                                               "O\'BRIEN,F.J.", "O\'SULLIVAN,T.J.", "PASKEY,L.", "RUBINOW,J.E.",
                                               "SADEN.G.A.", "SATANIELLO,A.G.", "SHEA,D.M.", "SHEA,J.F.JR.",
                                               "SIDOR,W.J.", "SPEZIALE,J.A.", "SPONZO,M.J.", "STAPLETON,J.F.",
                                               "TESTO,R.J.", "TIERNEY,W.L.JR.", "WALL,R.A.", "WRIGHT,D.B.",
                                               "ZARRILLI,K.J."))
```

> a.Determine the number of components to extract

```{r, message=FALSE}
library(psych)
fa.parallel(USJudgeRatings[, -1], fa = "pc", n.iter = 100, main = "Scree plot with parallel analysis")
abline(h = 1, lwd = 1, col = "black")
```

As shown in the graph:

- Based on the scree plot, there is one component's eigenvalue is greater than 1, so it suggests retaining a single component.

> b.Extract the components from raw data

```{r}
pc <- principal(USJudgeRatings[,-1], nfactors = 1)
pc
```

As shown in the graph:

- Each variable correlates highly with the first component (PC1).
- The column labeled h2 contains the component communalities—the amount of variance in each variable explained by the components. 
- The u2 column contains the component uniquenesses, the amount of variance not accounted for by the components (or 1–h2).
- The first principal component accounts for 92 percent of the variance in the 11 variables

> c.Rotate the components

Since there is just one component has been extracted, it's meaningless if we do the rotation.

> d.Compute component scores

```{r}
pc <- principal(USJudgeRatings[,-1], nfactors = 1, scores = TRUE)
pc$scores
```

It shows the principle component scores for each observation.

> e.Graph an orthogonal solution

```{r}
factor.plot(pc$loadings, cluster = 2)
```


## Problem2 (Perform Task2 on Glass Identification Data.xlsx)
```{r}
library(readxl)
Glass_Identification_Data <- read_excel("~/Desktop/2017 Fall Semester/IE 7275 Data Mining/HW/HW2/Glass Identification Data.xlsx")
```

> a.Determine the number of components to extract

```{r, warning=FALSE}
library(psych)
fa.parallel(Glass_Identification_Data[,2:10], fa="pc", main = "Scree plot with parallel analysis")
abline(h = 1, lwd = 1, col = "black")
```

As shown in the graph:

- Based on the scree plot, there are four components' eigenvalue is greater than 1, so it suggests retaining 4 components.

> b.Extract the components from raw data

```{r}
pc <- principal(Glass_Identification_Data[, 2:10], nfactors = 4, rotate = "none")
pc
```

As shown in the graph:

- The eigenvalues of these four components are 2.51, 2.05, 1.40, 1.16 respectively
- These four principal components account for 79 percent of the variance in the 9 variables

> c.Rotate the components

```{r}
rc <- principal(Glass_Identification_Data[, 2:10], nfactors = 4, rotate = "varimax")
rc
```

We can conclude that:

- The varimax rotation method has been applied in these step
- The portions of these four PC have been slightly changed from 0.35(PC1), 0.29(PC2), 0.20(PC3), 0.16(PC4) to 0.32(PC1), 0.28(PC2), 0.21(PC3), 0.19(PC4).
- RC1 is primarily defined by CA, RI; RC2 is primarily defined by Mg, Al and Ba; RC3 is primarily defined by Na, K and Fe, RC4 is primarily defined by Si
- The cumulative variance maintains as the same (79%)

> d.Compute component scores

```{r}
pc <- principal(Glass_Identification_Data[, 2:10], nfactors = 4, scores = TRUE)
head(pc$scores)
```

- The component scores could be computed by: PC1 in row1 = 0.84xRI - 0.06xNa - 0.35xMg + ... + 0.12xFe.

> e.Graph an orthogonal solution

```{r}
factor.plot(pc)
```

## Problem 3 (Perform Task3 on Harman23.cor)

```{r, echo=FALSE}
"Harman23.cor" <-
  structure(list(cov = structure(c(1, 0.846, 0.805, 0.859, 0.473, 
                                   0.398, 0.301, 0.382, 0.846, 1, 0.881, 0.826, 0.376, 0.326, 0.277, 
                                   0.415, 0.805, 0.881, 1, 0.801, 0.38, 0.319, 0.237, 0.345, 0.859, 
                                   0.826, 0.801, 1, 0.436, 0.329, 0.327, 0.365, 0.473, 0.376, 0.38, 
                                   0.436, 1, 0.762, 0.73, 0.629, 0.398, 0.326, 0.319, 0.329, 0.762, 
                                   1, 0.583, 0.577, 0.301, 0.277, 0.237, 0.327, 0.73, 0.583, 1, 
                                   0.539, 0.382, 0.415, 0.345, 0.365, 0.629, 0.577, 0.539, 1), .Dim = c(8, 
                                                                                                        8), .Dimnames = list(c("height", "arm.span", "forearm", "lower.leg", 
                                                                                                                               "weight", "bitro.diameter", "chest.girth", "chest.width"), c("height", 
                                                                                                                                                                                            "arm.span", "forearm", "lower.leg", "weight", "bitro.diameter", 
                                                                                                                                                                                            "chest.girth", "chest.width"))), center = c(0, 0, 0, 0, 0, 0, 
                                                                                                                                                                                                                                        0, 0), n.obs = 305), .Names = c("cov", "center", "n.obs"))
```

> a.Determine the number of components to extract

```{r}
str(Harman23.cor)
covariances <- Harman23.cor$cov
correlations <- cov2cor(covariances)
fa.parallel(correlations, n.obs = 305, fa = "both", main = "Scree plot with parallel analysis")
```
                                                                        
- Based on the scree plot, there are two components' eigenvalue is greater than 1, so it suggests retaining 2 components.

> b.Extract components

```{r}
fa1 <- fa(correlations, nfactors = 2, rotate = "none", fm = "pa")
fa1
```

- The eigenvalues of these two components are 4.45, 1.51 respectively
- These two principal components account for 74 percent of the variance in the 8 variables

> c.Rotate the factors

```{r}
fa2 <- fa(correlations, nfactors = 2, rotate = "varimax", fm = "pa")
fa2
```

- The varimax rotation method has been applied in these step
- The portions of these two PC have been slightly changed from 0.75(PC1), 0.25(PC2) to 0.55(PC1), 0.45(PC2).

> d.Obtain factor scores

```{r}
fa3 <- fa(correlations, nfactors = 2, rotate = "promax", fm = "pa")
fa3$weights 
```

> e.Graph an orthogonal solution using factor.plot()

```{r}
factor.plot(fa2)
```

> f.Graph an orblique solution using fa.diagram()

```{r}
fa.diagram(fa3)
```


## Problem 4 (Perform Task3 on Harman74.cor)

```{r, echo=FALSE}
"Harman74.cor" <-
  structure(list(cov = structure(c(1, 0.318, 0.403, 0.468, 0.321, 
                                   0.335, 0.304, 0.332, 0.326, 0.116, 0.308, 0.314, 0.489, 0.125, 
                                   0.238, 0.414, 0.176, 0.368, 0.27, 0.365, 0.369, 0.413, 0.474, 
                                   0.282, 0.318, 1, 0.317, 0.23, 0.285, 0.234, 0.157, 0.157, 0.195, 
                                   0.057, 0.15, 0.145, 0.239, 0.103, 0.131, 0.272, 0.005, 0.255, 
                                   0.112, 0.292, 0.306, 0.232, 0.348, 0.211, 0.403, 0.317, 1, 0.305, 
                                   0.247, 0.268, 0.223, 0.382, 0.184, -0.075, 0.091, 0.14, 0.321, 
                                   0.177, 0.065, 0.263, 0.177, 0.211, 0.312, 0.297, 0.165, 0.25, 
                                   0.383, 0.203, 0.468, 0.23, 0.305, 1, 0.227, 0.327, 0.335, 0.391, 
                                   0.325, 0.099, 0.11, 0.16, 0.327, 0.066, 0.127, 0.322, 0.187, 
                                   0.251, 0.137, 0.339, 0.349, 0.38, 0.335, 0.248, 0.321, 0.285, 
                                   0.247, 0.227, 1, 0.622, 0.656, 0.578, 0.723, 0.311, 0.344, 0.215, 
                                   0.344, 0.28, 0.229, 0.187, 0.208, 0.263, 0.19, 0.398, 0.318, 
                                   0.441, 0.435, 0.42, 0.335, 0.234, 0.268, 0.327, 0.622, 1, 0.722, 
                                   0.527, 0.714, 0.203, 0.353, 0.095, 0.309, 0.292, 0.251, 0.291, 
                                   0.273, 0.167, 0.251, 0.435, 0.263, 0.386, 0.431, 0.433, 0.304, 
                                   0.157, 0.223, 0.335, 0.656, 0.722, 1, 0.619, 0.685, 0.246, 0.232, 
                                   0.181, 0.345, 0.236, 0.172, 0.18, 0.228, 0.159, 0.226, 0.451, 
                                   0.314, 0.396, 0.405, 0.437, 0.332, 0.157, 0.382, 0.391, 0.578, 
                                   0.527, 0.619, 1, 0.532, 0.285, 0.3, 0.271, 0.395, 0.252, 0.175, 
                                   0.296, 0.255, 0.25, 0.274, 0.427, 0.362, 0.357, 0.501, 0.388, 
                                   0.326, 0.195, 0.184, 0.325, 0.723, 0.714, 0.685, 0.532, 1, 0.17, 
                                   0.28, 0.113, 0.28, 0.26, 0.248, 0.242, 0.274, 0.208, 0.274, 0.446, 
                                   0.266, 0.483, 0.504, 0.424, 0.116, 0.057, -0.075, 0.099, 0.311, 
                                   0.203, 0.246, 0.285, 0.17, 1, 0.484, 0.585, 0.408, 0.172, 0.154, 
                                   0.124, 0.289, 0.317, 0.19, 0.173, 0.405, 0.16, 0.262, 0.531, 
                                   0.308, 0.15, 0.091, 0.11, 0.344, 0.353, 0.232, 0.3, 0.28, 0.484, 
                                   1, 0.428, 0.535, 0.35, 0.24, 0.314, 0.362, 0.35, 0.29, 0.202, 
                                   0.399, 0.304, 0.251, 0.412, 0.314, 0.145, 0.14, 0.16, 0.215, 
                                   0.095, 0.181, 0.271, 0.113, 0.585, 0.428, 1, 0.512, 0.131, 0.173, 
                                   0.119, 0.278, 0.349, 0.11, 0.246, 0.355, 0.193, 0.35, 0.414, 
                                   0.489, 0.239, 0.321, 0.327, 0.344, 0.309, 0.345, 0.395, 0.28, 
                                   0.408, 0.535, 0.512, 1, 0.195, 0.139, 0.281, 0.194, 0.323, 0.263, 
                                   0.241, 0.425, 0.279, 0.382, 0.358, 0.125, 0.103, 0.177, 0.066, 
                                   0.28, 0.292, 0.236, 0.252, 0.26, 0.172, 0.35, 0.131, 0.195, 1, 
                                   0.37, 0.412, 0.341, 0.201, 0.206, 0.302, 0.183, 0.243, 0.242, 
                                   0.304, 0.238, 0.131, 0.065, 0.127, 0.229, 0.251, 0.172, 0.175, 
                                   0.248, 0.154, 0.24, 0.173, 0.139, 0.37, 1, 0.325, 0.345, 0.334, 
                                   0.192, 0.272, 0.232, 0.246, 0.256, 0.165, 0.414, 0.272, 0.263, 
                                   0.322, 0.187, 0.291, 0.18, 0.296, 0.242, 0.124, 0.314, 0.119, 
                                   0.281, 0.412, 0.325, 1, 0.324, 0.344, 0.258, 0.388, 0.348, 0.283, 
                                   0.36, 0.262, 0.176, 0.005, 0.177, 0.187, 0.208, 0.273, 0.228, 
                                   0.255, 0.274, 0.289, 0.362, 0.278, 0.194, 0.341, 0.345, 0.324, 
                                   1, 0.448, 0.324, 0.262, 0.173, 0.273, 0.287, 0.326, 0.368, 0.255, 
                                   0.211, 0.251, 0.263, 0.167, 0.159, 0.25, 0.208, 0.317, 0.35, 
                                   0.349, 0.323, 0.201, 0.334, 0.344, 0.448, 1, 0.358, 0.301, 0.357, 
                                   0.317, 0.272, 0.405, 0.27, 0.112, 0.312, 0.137, 0.19, 0.251, 
                                   0.226, 0.274, 0.274, 0.19, 0.29, 0.11, 0.263, 0.206, 0.192, 0.258, 
                                   0.324, 0.358, 1, 0.167, 0.331, 0.342, 0.303, 0.374, 0.365, 0.292, 
                                   0.297, 0.339, 0.398, 0.435, 0.451, 0.427, 0.446, 0.173, 0.202, 
                                   0.246, 0.241, 0.302, 0.272, 0.388, 0.262, 0.301, 0.167, 1, 0.413, 
                                   0.463, 0.509, 0.366, 0.369, 0.306, 0.165, 0.349, 0.318, 0.263, 
                                   0.314, 0.362, 0.266, 0.405, 0.399, 0.355, 0.425, 0.183, 0.232, 
                                   0.348, 0.173, 0.357, 0.331, 0.413, 1, 0.374, 0.451, 0.448, 0.413, 
                                   0.232, 0.25, 0.38, 0.441, 0.386, 0.396, 0.357, 0.483, 0.16, 0.304, 
                                   0.193, 0.279, 0.243, 0.246, 0.283, 0.273, 0.317, 0.342, 0.463, 
                                   0.374, 1, 0.503, 0.375, 0.474, 0.348, 0.383, 0.335, 0.435, 0.431, 
                                   0.405, 0.501, 0.504, 0.262, 0.251, 0.35, 0.382, 0.242, 0.256, 
                                   0.36, 0.287, 0.272, 0.303, 0.509, 0.451, 0.503, 1, 0.434, 0.282, 
                                   0.211, 0.203, 0.248, 0.42, 0.433, 0.437, 0.388, 0.424, 0.531, 
                                   0.412, 0.414, 0.358, 0.304, 0.165, 0.262, 0.326, 0.405, 0.374, 
                                   0.366, 0.448, 0.375, 0.434, 1), .Dim = c(24, 24), .Dimnames = list(
                                     c("VisualPerception", "Cubes", "PaperFormBoard", "Flags", 
                                       "GeneralInformation", "PargraphComprehension", "SentenceCompletion", 
                                       "WordClassification", "WordMeaning", "Addition", "Code", 
                                       "CountingDots", "StraightCurvedCapitals", "WordRecognition", 
                                       "NumberRecognition", "FigureRecognition", "ObjectNumber", 
                                       "NumberFigure", "FigureWord", "Deduction", "NumericalPuzzles", 
                                       "ProblemReasoning", "SeriesCompletion", "ArithmeticProblems"
                                     ), c("VisualPerception", "Cubes", "PaperFormBoard", "Flags", 
                                          "GeneralInformation", "PargraphComprehension", "SentenceCompletion", 
                                          "WordClassification", "WordMeaning", "Addition", "Code", 
                                          "CountingDots", "StraightCurvedCapitals", "WordRecognition", 
                                          "NumberRecognition", "FigureRecognition", "ObjectNumber", 
                                          "NumberFigure", "FigureWord", "Deduction", "NumericalPuzzles", 
                                          "ProblemReasoning", "SeriesCompletion", "ArithmeticProblems"
                                     ))), center = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
                                                     0, 0, 0, 0, 0, 0, 0, 0, 0, 0), n.obs = 145), .Names = c("cov", 
                                                                                                             "center", "n.obs"))
```

> a.Determine the number of components to extract

```{r}
str(Harman74.cor)
fa.parallel(Harman74.cor$cov, n.obs = 145, fa = "both", main = "Scree plot with parallel analysis")
```

- Based on the scree plot, there are four components' greater than the simulated value, so it suggests retaining 4 components.

> b.Extract components

```{r}
fa1 <- fa(Harman74.cor$cov, nfactors = 4, rotate = "none", fm = "pa")
fa1
```

- The eigenvalues of these four components are 7.65, 1.69, 1.22, 0.92 respectively
- These two principal components account for 48 percent of the variance in the 24 variables

> c.Rotate the factors

```{r}
fa2 <- fa(Harman74.cor$cov, nfactors = 4, rotate = "varimax", fm = "pa")
fa2
```

- The varimax rotation method has been applied in these step
- The portions of these four PC have been slightly changed from 0.67(PC1), 0.15(PC2), 0.11(PC3), 0.08(PC4) to 0.32(PC1), 0.26(PC2), 0.23(PC3), 0.19(PC4).

> d.Obtain factor scores

```{r}
fa3 <- fa(Harman74.cor$cov, nfactors = 4, rotate = "varimax", scores = TRUE)
fa3$weights
```

> e.Graph an orthogonal solution using factor.plot()

```{r}
factor.plot(fa3)
```

> f.Graph an oblique solution using fa.diagram()

```{r}
fa4 <- fa(Harman74.cor$cov, nfactors = 4, rotate = "promax", scores = TRUE)
fa.diagram(fa4)
```

This graph represents the solution after the varimax rotation.


# Problem 5 (Perform Task4 on Vertebral Column Data.xlsx)

```{r}
library(readxl)
Vertebral_Column_Data <- read_excel("~/Desktop/2017 Fall Semester/IE 7275 Data Mining/HW/HW2/Vertebral Column Data.xlsx")
```

> a.Determine the number of components to extracr

```{r, warning=FALSE}
library(psych)
fa.parallel(Vertebral_Column_Data[, 1:6], fa = "pc", n.iter = 100, main = "Scree plot with parallel analysis")
abline(h = 1, lwd = 1, col = "black")
```

- Based on the scree plot, there are two components' eigenvalue is greater than 1, so it suggests retaining 2 components.

> b.Perform Multidimensional Scaling

```{r}
d <- dist(Vertebral_Column_Data[, 1:6])
fit <- cmdscale(d,eig=TRUE, k=2)
head(fit$points)
head(fit$eig)
```

We set k=2, so the output is 2 dimensional, each row represents its point coordinate.

> c.Graph an orthogonbal solution nusing factor.plot()

```{r}
x <- fit$points[,1]
y <- fit$points[,2]
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2", main="Metric	MDS",	type="n")
text(x, y, labels = row.names(Vertebral_Column_Data[, -7]), cex=.7)
```

Most points are clustered in the center, only the 116th record is away from them, we can take it as an outlier.